// TODO
// 1. GET /tasks -> 목록으로 표시
// 2.

import axios from 'axios';

class {
    onCreate() {
        this.state = {
            tasks: [],
        };

        this.loadTasks();
    }

   async loadTasks(){
        const { data } = await axios.get('http://localhost:8080/tasks');
        this.state.tasks = data;
   }

   async addTask(){
        const title = this.getEl('title').value;
        await axios.post('http://localhost:8080/tasks',{
            title,
        });
        await this.loadTasks();
   }

   async updateTask(taskId,event){
           const title = this.getEl('title').value;
           await axios.put('http://localhost:8080/tasks'+taskId,{
               title,
           });
           await this.loadTasks();
      }

   async removeTask(taskId,event){
      event.preventDefault();
      await axios.delete('http://localhost:8080/tasks/' + taskId);
      await this.loadTasks();
   }
}

<h1>Todo</h1>

<ol>
    <for|task| of=state.tasks>
        <li key=task.id> ${task.title}  &nbsp;
            <button type="button" on-click("updateTask",task.id)>
                    수정
            </button>
            <button type="button" on-click("removeTask",task.id)>
                    삭제
            </button>
        </li>
    </for>
</ol>
<p>
    <label for:scoped="title">할일</label>
    <input type="text" id:scoped="title" key="title" />
    <button type="button" on-click("addTask")>
        추가
    </button>
</p>
